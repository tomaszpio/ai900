<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI-900 Question Bank</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light dark;
        font-family: 'Roboto', system-ui, -apple-system, BlinkMacSystemFont,
          'Segoe UI', sans-serif;
      }

      body {
        margin: 0;
        padding: 1.5rem clamp(1rem, 5vw, 3rem);
        background: #f5f7fb;
      }

      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      h1 {
        margin: 0;
        font-size: clamp(1.5rem, 3vw, 2.5rem);
        color: #0b5cab;
      }

      .return-home {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.45rem 0.85rem;
        background: #0b5cab;
        color: #ffffff;
        border-radius: 999px;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        box-shadow: 0 6px 16px rgba(11, 92, 171, 0.24);
        border: 1px solid rgba(255, 255, 255, 0.45);
        transition: transform 0.2s ease, box-shadow 0.2s ease,
          background-color 0.2s ease;
      }

      .return-home svg {
        width: 1em;
        height: 1em;
        fill: currentColor;
      }

      .return-home:hover,
      .return-home:focus-visible {
        background: #094a8c;
        box-shadow: 0 14px 28px rgba(9, 74, 140, 0.32);
        transform: translateY(-1px);
      }

      #questionContainer {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
      }

      .questionFormat {
        background: #ffffff;
        border-radius: 0.75rem;
        padding: 1.25rem;
        box-shadow: 0 10px 20px rgba(15, 23, 42, 0.08);
        border: 1px solid rgba(15, 23, 42, 0.08);
      }

      .questionFormat h2 {
        margin-top: 0;
        margin-bottom: 0.75rem;
        font-size: 1.1rem;
      }

      .questionFormat .explanation {
        margin-top: 0.75rem;
        padding: 0.85rem 0.95rem;
        background: #f1f7ff;
        border-radius: 0.65rem;
        border: 1px solid rgba(0, 90, 171, 0.18);
      }

      .questionFormat .explanation h3 {
        margin: 0 0 0.4rem;
        color: #0b5cab;
        font-size: 1rem;
      }

      .questionFormat .explanation p {
        margin: 0;
        color: #1f2937;
        line-height: 1.55;
      }

      .loading,
      .error {
        font-size: 1rem;
        margin-top: 1rem;
      }

      .error {
        color: #b42318;
      }
    </style>
  </head>
  <body>
    <header class="page-header">
      <h1>AI-900 Question Bank</h1>
      <a class="return-home" href="index.html">
        <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
          <path d="M12 4.248 4.5 10v10h5v-5h5v5h5V10z"></path>
        </svg>
        <span>Home</span>
      </a>
    </header>

    <p class="loading" id="status">Loading questionsâ€¦</p>
    <div id="questionContainer" hidden></div>

    <script>
      const dataUrl = 'data/create-copy-of-i900fromyoutube.json';
      const status = document.getElementById('status');
      const container = document.getElementById('questionContainer');

      function appendTextWithLineBreaks(target, text) {
        const lines = text.split('\n');
        lines.forEach((line, index) => {
          target.appendChild(document.createTextNode(line));
          if (index < lines.length - 1) {
            target.appendChild(document.createElement('br'));
          }
        });
      }

      function appendLinkifiedText(target, text) {
        // If the explanation already contains HTML (for example, anchor tags),
        // render it directly so that URLs remain clickable instead of appearing
        // as escaped text.
        if (/<\/?[a-z][\s\S]*>/i.test(text)) {
          target.innerHTML = text.replace(/\n/g, '<br>');
          return;
        }

        const fragment = document.createDocumentFragment();
        const urlPattern = /https?:\/\/[^\s]+/g;

        let lastIndex = 0;
        for (const match of text.matchAll(urlPattern)) {
          const preceding = text.slice(lastIndex, match.index);
          appendTextWithLineBreaks(fragment, preceding);

          const anchor = document.createElement('a');
          anchor.href = match[0];
          anchor.target = '_blank';
          anchor.rel = 'noopener noreferrer';
          anchor.textContent = match[0];
          fragment.appendChild(anchor);

          lastIndex = match.index + match[0].length;
        }

        appendTextWithLineBreaks(fragment, text.slice(lastIndex));
        target.appendChild(fragment);
      }

      function renderQuestion(question) {
        const wrapper = document.createElement('article');
        wrapper.className = 'questionFormat';

        const heading = document.createElement('h2');
        heading.textContent = question.title || `Question ${question.question_number}`;
        wrapper.appendChild(heading);

        const questionBlock = document.createElement('div');
        questionBlock.innerHTML = question.question_html ||
          `<p>${question.question_text ?? 'Question text unavailable.'}</p>`;
        wrapper.appendChild(questionBlock);

        if (question.answer_html) {
          const answerBlock = document.createElement('div');
          answerBlock.innerHTML = question.answer_html;
          wrapper.appendChild(answerBlock);
        }

        if (question.explanation_en) {
          const explanation = document.createElement('div');
          explanation.className = 'explanation';

          const explanationHeading = document.createElement('h3');
          explanationHeading.textContent = 'Explanation';
          explanation.appendChild(explanationHeading);

          const explanationCopy = document.createElement('p');
          appendLinkifiedText(explanationCopy, question.explanation_en);
          explanation.appendChild(explanationCopy);

          wrapper.appendChild(explanation);
        }

        return wrapper;
      }

      async function loadQuestions() {
        try {
          const response = await fetch(dataUrl);
          if (!response.ok) {
            throw new Error(`Unable to fetch data: ${response.status}`);
          }
          const payload = await response.json();
          const fragment = document.createDocumentFragment();
          payload.questions.forEach((question) => {
            fragment.appendChild(renderQuestion(question));
          });
          container.innerHTML = '';
          container.appendChild(fragment);
          container.hidden = false;
          status.textContent = `${payload.question_count} questions loaded from JSON.`;
        } catch (error) {
          console.error(error);
          status.textContent = 'Failed to load question data. Please ensure the JSON file is accessible.';
          status.classList.add('error');
        }
      }

      loadQuestions();
    </script>
  </body>
</html>
