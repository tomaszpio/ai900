<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Azure AI Services Knowledge Graph</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light dark;
      --surface: #ffffff;
      --surface-alt: #eef3fb;
      --surface-strong: #0f172a;
      --border: #d0d7de;
      --accent: #0078d4;
      --accent-strong: #004c87;
      --accent-soft: rgba(0, 120, 212, 0.12);
      --text: #1f1f1f;
      --muted: #5f6a7d;
      --shadow: rgba(15, 23, 42, 0.12);
      --chip-preview: #9457eb;
      --chip-ga: #107c10;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--surface-alt);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .return-home {
      position: fixed;
      top: clamp(0.75rem, 2vw, 1.25rem);
      right: clamp(0.75rem, 3vw, 1.5rem);
      z-index: 1000;
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      padding: 0.6rem 1.1rem;
      background: var(--accent, #0b5cab);
      color: #ffffff;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.95rem;
      border: 1px solid rgba(255, 255, 255, 0.45);
      box-shadow: 0 12px 28px rgba(0, 60, 136, 0.22);
      transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
    }

    .return-home svg {
      width: 1em;
      height: 1em;
      fill: currentColor;
    }

    .return-home:hover,
    .return-home:focus-visible {
      background: var(--accent-strong, #004c87);
      box-shadow: 0 14px 32px rgba(0, 60, 136, 0.28);
      transform: translateY(-1px);
    }

    @media (max-width: 640px) {
      .return-home {
        font-size: 0.85rem;
        padding: 0.5rem 0.95rem;
        top: 0.75rem;
        right: 0.75rem;
      }
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    header {
      background: radial-gradient(circle at 20% 20%, rgba(0, 120, 212, 0.25), transparent 60%),
        radial-gradient(circle at 80% 30%, rgba(0, 60, 136, 0.45), transparent 55%),
        linear-gradient(135deg, #002050, #0a5cbf);
      color: white;
      padding: clamp(2rem, 6vw, 3rem) clamp(1.5rem, 6vw, 4rem);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      position: relative;
      overflow: hidden;
    }

    header::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.18), transparent 60%);
      pointer-events: none;
    }

    header h1 {
      margin: 0 0 0.5rem 0;
      font-weight: 600;
      font-size: clamp(2.1rem, 4vw, 3rem);
    }

    header p {
      max-width: 70ch;
      margin: 0;
      opacity: 0.92;
      font-size: 1.05rem;
    }

    .header-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-bottom: 1.25rem;
      align-items: center;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      background: rgba(255, 255, 255, 0.16);
      color: white;
      padding: 0.4rem 0.75rem;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 600;
      letter-spacing: 0.01em;
    }

    .badge svg {
      width: 16px;
      height: 16px;
    }

    main {
      flex: 1;
      display: grid;
      grid-template-columns: minmax(0, 7fr) minmax(0, 3fr);
      gap: clamp(1.5rem, 3vw, 2.75rem);
      padding: clamp(1.75rem, 4vw, 3rem);
    }

    .graph-card,
    .details-card {
      background: var(--surface);
      border-radius: 16px;
      border: 1px solid var(--border);
      box-shadow: 0 20px 45px var(--shadow);
      padding: clamp(1.5rem, 3vw, 2.5rem);
    }

    .details-card {
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .details-card h2 {
      margin-top: 0;
      font-size: 1.35rem;
      color: var(--accent);
    }

    .details-card h3 {
      margin: 0;
      font-size: 1.25rem;
    }

    .details-header {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .details-card p {
      margin: 0.35rem 0 0;
      line-height: 1.55;
      color: var(--muted);
    }

    .details-card h4 {
      margin: 1.25rem 0 0.35rem;
      font-size: 1rem;
      color: var(--text);
    }

    .details-card ul {
      margin: 0;
      padding-left: 1.1rem;
      color: var(--muted);
    }

    .details-card li {
      margin-bottom: 0.35rem;
    }

    .details-card .placeholder {
      margin-top: 2rem;
      padding: 1rem;
      border-radius: 12px;
      border: 1px dashed var(--border);
      background: var(--surface-alt);
      text-align: center;
      color: var(--muted);
      font-style: italic;
    }

    .details-meta {
      margin: 0.75rem 0 0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.25rem 0.55rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      background: rgba(15, 23, 42, 0.08);
      color: var(--surface-strong);
    }

    .chip--ga {
      background: rgba(16, 124, 16, 0.12);
      color: var(--chip-ga);
    }

    .chip--preview {
      background: rgba(148, 87, 235, 0.12);
      color: var(--chip-preview);
    }

    .cta {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      margin-top: 1.25rem;
      font-weight: 600;
      color: var(--accent-strong);
      text-decoration: none;
    }

    .cta:hover,
    .cta:focus {
      text-decoration: underline;
    }

    .legend {
      margin-top: auto;
      padding-top: 2rem;
      display: grid;
      gap: 0.75rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.95rem;
      color: var(--muted);
    }

    .legend-swatch {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      border: 2px solid transparent;
    }

    .update-panel {
      padding: 0 clamp(1.75rem, 4vw, 3rem) clamp(2.5rem, 5vw, 3.5rem);
    }

    .update-card {
      background: var(--surface);
      border-radius: 16px;
      border: 1px solid var(--border);
      box-shadow: 0 18px 38px var(--shadow);
      padding: clamp(1.5rem, 3vw, 2.25rem);
      display: grid;
      gap: 1.5rem;
    }

    .update-card h2 {
      margin: 0;
      color: var(--accent);
      font-size: 1.45rem;
    }

    .key-insights {
      display: grid;
      gap: 0.85rem;
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .key-insights li {
      display: flex;
      gap: 0.6rem;
      align-items: flex-start;
      color: var(--muted);
    }

    .key-insights span {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 26px;
      height: 26px;
      border-radius: 8px;
      background: var(--accent-soft);
      color: var(--accent-strong);
      font-weight: 600;
      flex-shrink: 0;
    }

    .key-insights div {
      line-height: 1.55;
      flex: 1;
    }

    #graph {
      width: 100%;
      height: clamp(24rem, 60vh, 32rem);
    }

    .node circle {
      fill: white;
      stroke: var(--accent);
      stroke-width: 2px;
      cursor: pointer;
      transition: fill 0.2s ease, stroke-width 0.2s ease;
    }

    .node circle:hover {
      fill: var(--accent-soft);
      stroke-width: 3px;
    }

    .node text {
      font-size: 0.85rem;
      font-weight: 600;
      fill: var(--text);
      pointer-events: none;
    }

    .link {
      fill: none;
      stroke: var(--border);
      stroke-width: 2px;
    }

    .node--category circle {
      fill: rgba(0, 120, 212, 0.08);
    }

    .node--root circle {
      fill: rgba(0, 120, 212, 0.12);
    }

    @media (max-width: 960px) {
      main {
        grid-template-columns: 1fr;
      }

      .graph-card {
        order: 2;
      }

      .details-card {
        order: 1;
      }

      .update-panel {
        padding: 0 1.5rem 2.5rem;
      }
    }

    @media (max-width: 640px) {
      body {
        padding: 1.5rem;
      }

      header {
        padding: 2rem 1.5rem;
      }

      main {
        padding: 1.5rem 0;
      }

      .update-panel {
        padding: 0 0 2rem;
      }
    }
  </style>
</head>
<body>
  <a class="return-home" href="index.html">
    <svg aria-hidden="true" viewBox="0 0 24 24" focusable="false">
      <path d="M12 4.248 4.5 10v10h5v-5h5v5h5V10z"></path>
    </svg>
    <span>Home</span>
  </a>
  <header>
    <div class="header-meta">
      <span class="badge" aria-label="Updated for 2024">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" role="img" aria-hidden="true">
          <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.144.044l-4-4.5a.75.75 0 1 1 1.114-1.004l3.404 3.83 7.45-9.776a.75.75 0 0 1 1.033-.146z" clip-rule="evenodd" />
        </svg>
        Updated February 2024
      </span>
      <span class="badge" aria-label="Reference for Azure AI-900">
        Azure AI-900 reference companion
      </span>
    </div>
    <h1>Azure AI Services Knowledge Graph</h1>
    <p>
      Explore how Azure AI services are organized in the latest Azure AI portfolio. Select a service or category to review
      its description, typical capabilities, usage scenarios, and links to documentation.
    </p>
  </header>
  <main>
    <section class="graph-card" aria-label="Graph of Azure AI services">
      <svg id="graph" role="img" aria-labelledby="graph-title"></svg>
      <span id="graph-title" class="sr-only">Interactive graph showing Azure AI services hierarchy</span>
    </section>
    <aside class="details-card" aria-live="polite" aria-atomic="true">
      <h2 id="details-title">Service details</h2>
      <div id="details-content">
        <div class="placeholder">Select a node in the graph to view its description, capabilities, and common scenarios.</div>
      </div>
      <div class="legend" aria-hidden="true">
        <div class="legend-item">
          <span class="legend-swatch" style="background: rgba(0, 120, 212, 0.12);"></span>
          <span>Azure AI services (root)</span>
        </div>
        <div class="legend-item">
          <span class="legend-swatch" style="background: rgba(0, 120, 212, 0.08);"></span>
          <span>Service categories</span>
        </div>
        <div class="legend-item">
          <span class="legend-swatch" style="background: white; border-color: var(--accent);"></span>
          <span>Individual services</span>
        </div>
      </div>
    </aside>
  </main>
  <section class="update-panel" aria-label="Latest updates for Azure AI services">
    <div class="update-card">
      <h2>What's new in the Azure AI Services line-up</h2>
      <p>
        Microsoft continues to evolve the Azure AI portfolio by adding orchestration tools and refreshed branding. The
        knowledge graph and the notes in this companion capture highlights you should know for the AI-900 exam or solution
        planning discussions.
      </p>
      <ul class="key-insights">
        <li><span>1</span><div><strong>Azure AI Studio</strong> brings orchestration, prompt flow, and monitoring into a
          single canvas for building enterprise copilots.</div></li>
        <li><span>2</span><div><strong>Azure AI Search</strong> (formerly Cognitive Search) is emphasized as the knowledge
          mining layer for grounding generative AI responses.</div></li>
        <li><span>3</span><div><strong>Content Safety</strong> and <strong>Responsible AI</strong> tooling receive new
          capabilities to moderate both text and imagery generated by AI systems.</div></li>
      </ul>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js" integrity="sha512-vc58qvvBdrDR4etbxMdlTt4GBQk1qjvyORR2nrsPsFPyrs+/u5c3+1Ct6upOgdZoIl7eq6k3a1UPDSNAQi/32A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    const servicesData = {
      name: 'Azure AI Services',
      status: 'General availability',
      description: 'A collection of ready-made AI capabilities spanning language, vision, speech, search, and decision-making. Services are delivered through REST APIs, SDKs, and Azure AI Studio experiences.',
      capabilities: [
        'Prebuilt cognitive capabilities and generative AI orchestration',
        'Integration with Azure platform governance and security',
        'Support for multiple programming languages, SDKs, and no-code tools'
      ],
      scenarios: [
        'Add intelligent features without building models from scratch',
        'Ground generative AI solutions with enterprise data',
        'Accelerate AI solution delivery with reusable Azure building blocks'
      ],
      children: [
        {
          name: 'Language Services',
          type: 'category',
          description: 'Understand, translate, and generate natural language with pretrained models and conversational AI capabilities.',
          capabilities: [
            'Natural language understanding',
            'Multilingual translation and speech enablement',
            'Conversational orchestration and summarization'
          ],
          scenarios: [
            'Multilingual chatbots and virtual agents',
            'Text summarization and sentiment analysis',
            'Automated document classification'
          ],
          children: [
            {
              name: 'Azure AI Language',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/language-service/overview',
              description: 'Unified language service with capabilities for text analytics, question answering, and conversational language understanding.',
              capabilities: [
                'Sentiment and opinion mining',
                'Entity recognition and key phrase extraction',
                'Custom text classification and conversational orchestration'
              ],
              scenarios: [
                'Monitor customer feedback across channels',
                'Build FAQ bots that extract answers from knowledge bases',
                'Route and classify support tickets automatically'
              ]
            },
            {
              name: 'Azure AI Speech',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/speech-service/overview',
              description: 'Convert speech to text, synthesize speech, and translate conversations in real time.',
              capabilities: [
                'Speech-to-text with custom acoustic tuning',
                'Text-to-speech with neural voices',
                'Real-time speech translation and speaker diarization'
              ],
              scenarios: [
                'Meeting transcription and insights',
                'Interactive voice response systems',
                'Assistive solutions for accessibility'
              ]
            },
            {
              name: 'Azure OpenAI Service',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/openai/overview',
              description: 'Access OpenAI large language models for generation, summarization, and semantic search with Azure enterprise promises.',
              capabilities: [
                'GPT models for content generation',
                'Embeddings for search and knowledge mining',
                'Fine-tuning and safety moderation tools'
              ],
              scenarios: [
                'Automated report and content generation',
                'Conversational copilots and assistants',
                'Code completion and knowledge retrieval'
              ]
            },
            {
              name: 'Azure AI Translator',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/translator/',
              description: 'Neural machine translation service supporting more than 100 languages with custom terminology options.',
              capabilities: [
                'Real-time and batch text translation',
                'Custom glossary and terminology support',
                'Document translation with built-in formats'
              ],
              scenarios: [
                'Localizing product content and documentation',
                'Cross-border collaboration and chat translation',
                'Multi-language knowledge base publishing'
              ]
            }
          ]
        },
        {
          name: 'Vision Services',
          type: 'category',
          description: 'Analyze images and video to detect objects, extract text, and build custom vision models.',
          capabilities: [
            'Image recognition and classification',
            'Optical character recognition (OCR)',
            'Custom vision model training'
          ],
          scenarios: [
            'Automated content moderation',
            'Smart manufacturing defect detection',
            'Document digitization and form processing'
          ],
          children: [
            {
              name: 'Azure AI Vision',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/computer-vision/overview',
              description: 'Prebuilt and custom computer vision APIs for image analysis, spatial analysis, and face detection.',
              capabilities: [
                'Tagging, description, and object detection',
                'Spatial analysis for people counting and occupancy',
                'Face recognition with responsible AI controls'
              ],
              scenarios: [
                'Retail shelf analytics',
                'Facility safety monitoring',
                'Content accessibility with image descriptions'
              ]
            },
            {
              name: 'Custom Vision',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/custom-vision-service/overview',
              description: 'Train, deploy, and improve custom image classification and object detection models.',
              capabilities: [
                'No-code model training interface',
                'Active learning with tagging assistance',
                'Edge deployment for offline inference'
              ],
              scenarios: [
                'Predictive maintenance using visual inspections',
                'Agricultural crop monitoring',
                'Quality assurance in manufacturing'
              ]
            },
            {
              name: 'Azure AI Video Indexer',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/azure-video-indexer/video-indexer-overview',
              description: 'Extract searchable insights from audio and video, including transcripts, people, and scene segmentation.',
              capabilities: [
                'Automatic transcription and translation',
                'Face and speaker detection',
                'Scene and topic segmentation with insights'
              ],
              scenarios: [
                'Media archive discovery',
                'Content compliance and moderation',
                'Video metadata enrichment for search'
              ]
            }
          ]
        },
        {
          name: 'Document Intelligence',
          type: 'category',
          description: 'Apply AI to extract structured data from documents, forms, and invoices.',
          capabilities: [
            'Prebuilt models for invoices, receipts, IDs',
            'Custom document processing with labeling',
            'Document classification and splitting'
          ],
          scenarios: [
            'Accounts payable automation',
            'Customer onboarding with ID verification',
            'Digitizing paper records into structured data'
          ],
          children: [
            {
              name: 'Azure AI Document Intelligence',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/document-intelligence/overview',
              description: 'Extract text, key-value pairs, tables, and structures from documents using template-less AI models.',
              capabilities: [
                'Prebuilt models for common business documents',
                'Custom models built with labeled data',
                'Workflow automation via REST APIs and Logic Apps'
              ],
              scenarios: [
                'Invoice processing and matching',
                'Loan document review automation',
                'Regulatory compliance record digitization'
              ]
            },
            {
              name: 'Form Recognizer Studio',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/ai-services/document-intelligence/studio-overview',
              description: 'Studio experience for labeling, testing, and deploying custom document models within Azure AI.',
              capabilities: [
                'Visual data labeling and testing workflows',
                'Model versioning and evaluation metrics',
                'Integration with Azure AI Document Intelligence APIs'
              ],
              scenarios: [
                'Citizen developer document automation',
                'Iterative improvement of extraction models',
                'Operational hand-off between business and dev teams'
              ]
            }
          ]
        },
        {
          name: 'Knowledge & Search',
          type: 'category',
          description: 'Ground generative AI and applications with enterprise search, semantic ranking, and knowledge mining.',
          capabilities: [
            'Cognitive search with semantic ranking',
            'Vector search with hybrid retrieval',
            'Indexing for documents, images, and structured data'
          ],
          scenarios: [
            'Retrieval augmented generation (RAG)',
            'Knowledge mining over enterprise content',
            'E-discovery and document search portals'
          ],
          children: [
            {
              name: 'Azure AI Search',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/search/search-what-is-azure-search',
              description: 'Formerly Azure Cognitive Search. Provides vector, semantic, and keyword search over ingested content.',
              capabilities: [
                'Integrated vector and semantic ranking',
                'Indexers for files, Azure storage, and Cosmos DB',
                'Built-in skillsets for enrichment and chunking'
              ],
              scenarios: [
                'Grounding generative AI copilots with enterprise data',
                'Multi-language knowledge mining portals',
                'Product catalog search and discovery'
              ]
            },
            {
              name: 'Azure AI Content Safety',
              status: 'Preview',
              link: 'https://learn.microsoft.com/azure/ai-services/content-safety/overview',
              description: 'Moderate harmful or sensitive content across text and images with configurable thresholds and audit tools.',
              capabilities: [
                'Text and image classification for safety categories',
                'Real-time content filtering APIs',
                'Safety reports for human review workflows'
              ],
              scenarios: [
                'Moderating user-generated content in communities',
                'Filtering prompts and responses in generative AI apps',
                'Compliance reporting for regulated industries'
              ]
            }
          ]
        },
        {
          name: 'Decision & Applied AI',
          type: 'category',
          description: 'Infuse applications with personal recommendations, anomaly detection, and domain-specific AI agents.',
          capabilities: [
            'Personalization and recommendations',
            'Anomaly detection and forecasting',
            'Business process automation with orchestration'
          ],
          scenarios: [
            'Adaptive customer experiences',
            'Operational monitoring and alerting',
            'Contact center productivity'
          ],
          children: [
            {
              name: 'Personalizer',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/cognitive-services/personalizer/what-is-personalizer',
              description: 'Deliver contextual, personalized experiences using reinforcement learning.',
              capabilities: [
                'Real-time learning from rewards',
                'Exploration vs exploitation balancing',
                'Built-in evaluation and offline experimentation'
              ],
              scenarios: [
                'Personalized content recommendations',
                'Context-aware app experiences',
                'Targeted promotions and offers'
              ]
            },
            {
              name: 'Metrics Advisor',
              status: 'General availability',
              link: 'https://learn.microsoft.com/azure/applied-ai-services/metrics-advisor/overview',
              description: 'Monitor time-series data to detect anomalies and diagnose issues quickly.',
              capabilities: [
                'Adaptive anomaly detection models',
                'Root cause analysis and incident management',
                'Multivariate analysis across metrics'
              ],
              scenarios: [
                'Application performance monitoring',
                'IoT operations anomaly detection',
                'Business KPI tracking'
              ]
            },
            {
              name: 'Azure AI Studio',
              status: 'Preview',
              link: 'https://learn.microsoft.com/azure/ai-studio/overview',
              description: 'Unified authoring canvas for building and orchestrating generative AI copilots and agents.',
              capabilities: [
                'Graphical flow and agent design',
                'Integration with Azure OpenAI and AI Search',
                'Safety, monitoring, and deployment tools'
              ],
              scenarios: [
                'Enterprise copilot development',
                'Knowledge-grounded assistants',
                'Responsible deployment and lifecycle management'
              ]
            }
          ]
        }
      ]
    };

    const svg = d3.select('#graph');
    const width = svg.node().clientWidth;
    const height = svg.node().clientHeight;

    const g = svg
      .attr('viewBox', `0 0 ${width} ${height}`)
      .append('g')
      .attr('transform', 'translate(60, 20)');

    const treeLayout = d3.tree().size([height - 40, width - 160]);
    const root = d3.hierarchy(servicesData);

    root.x0 = height / 2;
    root.y0 = 0;

    const linkGenerator = d3.linkHorizontal()
      .x(d => d.y)
      .y(d => d.x);

    const update = source => {
      const treeData = treeLayout(root);
      const nodes = treeData.descendants();
      const links = treeData.links();

      nodes.forEach(d => d.y = d.depth * 180);

      const node = g.selectAll('g.node')
        .data(nodes, d => d.id || (d.id = d.data.name));

      const nodeEnter = node.enter()
        .append('g')
        .attr('class', d => `node node--${d.depth === 0 ? 'root' : d.data.type || 'service'}`)
        .attr('transform', d => `translate(${source.y0},${source.x0})`);

      nodeEnter.append('circle')
        .attr('r', 1e-6)
        .on('click', (event, d) => {
          event.stopPropagation();
          showDetails(d.data);
          if (d.children) {
            d._children = d.children;
            d.children = null;
          } else {
            d.children = d._children;
            d._children = null;
          }
          update(d);
        });

      nodeEnter.append('text')
        .attr('dy', '0.35em')
        .attr('x', d => d.depth === 0 ? -10 : 12)
        .attr('text-anchor', d => d.depth === 0 ? 'end' : 'start')
        .text(d => d.data.name)
        .style('fill-opacity', 1e-6);

      const nodeUpdate = nodeEnter.merge(node);

      nodeUpdate.transition()
        .duration(300)
        .attr('transform', d => `translate(${d.y},${d.x})`);

      nodeUpdate.select('circle')
        .transition()
        .duration(300)
        .attr('r', 16);

      nodeUpdate.select('text')
        .transition()
        .duration(300)
        .style('fill-opacity', 1)
        .attr('x', d => d.depth === 0 ? -20 : 20)
        .attr('text-anchor', d => d.depth === 0 ? 'end' : 'start');

      const nodeExit = node.exit().transition()
        .duration(300)
        .attr('transform', d => `translate(${source.y},${source.x})`)
        .remove();

      nodeExit.select('circle')
        .attr('r', 1e-6);

      nodeExit.select('text')
        .style('fill-opacity', 1e-6);

      const link = g.selectAll('path.link')
        .data(links, d => d.target.id);

      const linkEnter = link.enter().insert('path', 'g')
        .attr('class', 'link')
        .attr('d', () => {
          const o = { x: source.x0, y: source.y0 };
          return linkGenerator({ source: o, target: o });
        });

      linkEnter.merge(link).transition()
        .duration(300)
        .attr('d', linkGenerator);

      link.exit().transition()
        .duration(300)
        .attr('d', () => {
          const o = { x: source.x, y: source.y };
          return linkGenerator({ source: o, target: o });
        })
        .remove();

      nodes.forEach(d => {
        d.x0 = d.x;
        d.y0 = d.y;
      });
    };

    const collapseAll = node => {
      if (node.children) {
        node._children = node.children;
        node._children.forEach(collapseAll);
        node.children = null;
      }
    };

    root.children.forEach(collapseAll);
    update(root);
    showDetails(root.data);

    function showDetails(data) {
      const content = document.getElementById('details-content');
      const metadata = [];

      if (data.status) {
        const normalized = data.status.toLowerCase().includes('preview') ? 'preview' : 'ga';
        metadata.push(`<span class="chip chip--${normalized}">${data.status}</span>`);
      }

      if (data.type === 'category') {
        metadata.push('<span class="chip">Service category</span>');
      }

      content.innerHTML = `
        <div class="details-header">
          <h3>${data.name}</h3>
          ${metadata.length ? `<div class="details-meta">${metadata.join('')}</div>` : ''}
        </div>
        <p>${data.description || 'Explore this node to learn more.'}</p>
        ${Array.isArray(data.capabilities) ? renderList('Key capabilities', data.capabilities) : ''}
        ${Array.isArray(data.scenarios) ? renderList('Common scenarios', data.scenarios) : ''}
        ${data.link ? `<a class="cta" href="${data.link}" target="_blank" rel="noopener">Open documentation →</a>` : ''}
      `;
    }

    function renderList(title, items) {
      if (!items.length) return '';
      const listItems = items.map(item => `<li>${item}</li>`).join('');
      return `
        <h4>${title}</h4>
        <ul>${listItems}</ul>
      `;
    }
  </script>
</body>
</html>
